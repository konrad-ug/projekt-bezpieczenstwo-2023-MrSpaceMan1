FROM node:19-alpine AS BUILD

COPY . /opt/kiosk

WORKDIR /opt/kiosk

RUN [ "npm", "i" ]

ARG AUTH_PROVIDER
ARG AUTH_PROVIDER_PORT
ARG APP_HOST
ARG APP_PORT

ENV REACT_APP_AUTH_PROVIDER=$AUTH_PROVIDER
ENV REACT_APP_AUTH_PROVIDER_PORT=$AUTH_PROVIDER_PORT
ENV REACT_APP_APP_HOST=$APP_HOST
ENV REACT_APP_APP_PORT=$APP_PORT
ENV PORT = $APP_PORT

EXPOSE $APP_PORT

ENTRYPOINT [ "npm", "run", "start" ]
